<?xml version="1.0" encoding="UTF-8"?>
<database>
	<!-- 
		* Username - Account name, used to log in.
		* Password - SHA1 encrypted password, stored in a finalized byte array encoded into a hex octet string
		* Super User - A super user can always login to a game server, provided the game server itself is not offline.
		In other words, this account can login during maintenance as well as into a full game server.
		* Birth Date - Account owner's birth date. Used to prohibit access to
		certain gameservers or during specific time of day (night).
		If IS NULL then no checks are made.
		* Last Login - Time of last login using this account, in ms since the epoch.
		If IS NULL then an account has never been used.
		* Last Server ID - ID of last game server that was successfully logged into.
		If IS NULL then an account has never (successfully) logged into a game server.
		* Ban Reason - ID that defines why an account has been suspended and can no longer be used to log in.
		If IS NULL then an account may be used to log in.
	-->
	<!-- Table must not be preloaded. -->
	<table name="account"
		definition="
			CREATE TABLE account (
				username		VARCHAR(45)	NOT NULL,
				password		CHAR(40)	NOT NULL,
				superuser		BOOLEAN		NOT NULL	DEFAULT FALSE,
				birthDate		DATE					DEFAULT NULL,
				lastLogin		BIGINT					DEFAULT NULL,
				lastServerId	SMALLINT				DEFAULT NULL,
				banReason		SMALLINT				DEFAULT NULL,
				PRIMARY KEY (username)
			);
	" />
	<!-- 
		* ID - server ID in the game server list.
		* Auth Data - A randomly generated byte array used to distinguish authorized game servers.
		* Allow Bans - Whether to allow account bans requested by this game server.
	-->
	<!-- Table must not be preloaded. -->
	<table name="gameserver"
		definition="
			CREATE TABLE gameserver (
				id			SMALLINT	NOT NULL,
				authData	CHAR(128)	NOT NULL,
				allowBans	BOOLEAN		NOT NULL,
				PRIMARY KEY (id)
			);
	" />
	<!-- 
		* Username - Account name, used to log in.
		* IPv4 - IP address that initiated the login.
		* Date_ - Date of (successful) login. Login server may choose not to
		provide this information and thus a constant may be used here.
	-->
	<table name="logins"
		definition="
		CREATE TABLE logins (
			username	VARCHAR(45)	NOT NULL,
			ipv4		CHAR(15)	NOT NULL,
			date_		DATE		NOT NULL,
			PRIMARY KEY (username, ipv4, date_)
		);
	" />
	<!-- 
		* IPv4 - Connections from this IP address should be dropped.
		* Expiry - Time when this restriction expires, in ms since the epoch.
		If IS NULL then it never expires.
	-->
	<!-- For Login Server managed restrictions only. Records added manually may be ignored. -->
	<!-- Permanent IP range restrictions must be stored in an XML file. -->
	<!-- Table may be preloaded to achieve better performance. -->
	<table name="restriction"
		definition="
		CREATE TABLE restriction (
			ipv4	CHAR(15)	NOT NULL,
			expiry	BIGINT					DEFAULT NULL,
			PRIMARY KEY (ipv4)
		);
	" />
</database>
